<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Toâ€‘Do List â€” Vanilla JS</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#60a5fa; --muted:#94a3b8; --success:#34d399;
      --danger:#fb7185; --glass: rgba(255,255,255,0.03);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,var(--bg),#081224); color:#e6eef8; display:flex; align-items:center; justify-content:center; padding:32px;
    }
    .app{
      width:100%; max-width:720px; background:linear-gradient(180deg,var(--card), rgba(11,17,32,0.9)); border-radius:14px; padding:20px; box-shadow:0 10px 30px rgba(2,6,23,0.6);
      backdrop-filter: blur(6px);
    }
    header{display:flex; align-items:center; gap:12px}
    header h1{margin:0; font-size:20px; letter-spacing:0.4px}
    .new-task{display:flex; gap:8px; margin-top:14px}
    .new-task input[type=text]{flex:1; padding:12px 14px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:var(--glass); color:inherit; outline:none}
    .new-task button{padding:0 14px; border-radius:10px; border:0; background:var(--accent); color:#04202a; font-weight:600; cursor:pointer}
    .new-task button:active{transform:translateY(1px)}
    .meta{display:flex; justify-content:space-between; align-items:center; margin-top:12px; color:var(--muted); font-size:13px}
    .filters{display:flex; gap:8px}
    .filters button{background:transparent;border:1px solid transparent;padding:6px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
    .filters button.active{border-color:rgba(255,255,255,0.06); color:var(--accent); font-weight:600}
    ul.todo-list{list-style:none;padding:0;margin:16px 0 8px; max-height:360px; overflow:auto}
    li.todo{display:flex; align-items:center; gap:10px; padding:10px; border-radius:10px; margin-bottom:8px;background:linear-gradient(90deg, rgba(255,255,255,0.01), transparent);}
    li.todo .cb{width:18px;height:18px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
    li.todo.completed .label{opacity:0.5; text-decoration:line-through}
    .label{flex:1; padding:6px 4px}
    .actions{display:flex;gap:8px}
    .icon-btn{background:transparent;border:0;color:var(--muted);cursor:pointer;padding:6px;border-radius:8px}
    .count{font-size:13px}
    .small{font-size:13px;color:var(--muted)}
    /* responsive */
    @media (max-width:520px){.app{padding:14px}.new-task input[type=text]{padding:10px}.new-task button{padding:0 10px}}
  </style>
</head>
<body>
  <main class="app" role="application" aria-label="To-do list application">
    <header>
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <rect x="3" y="4" width="18" height="16" rx="4" fill="white" opacity="0.06"></rect>
        <path d="M8 11.5l2 2 5-6" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" opacity="0.9"/>
      </svg>
      <div>
        <h1>Toâ€‘Do List</h1>
        <div class="small">Simple, fast, and local â€” built with plain JavaScript</div>
      </div>
    </header>

    <section class="new-task" aria-label="Add new task">
      <input id="taskInput" type="text" placeholder="What needs to be done? (press Enter to add)" aria-label="New task">
      <button id="addBtn" aria-label="Add task">Add</button>
    </section>

    <div class="meta">
      <div class="count" id="itemsLeft">0 items left</div>
      <div class="filters" role="tablist" aria-label="Filter tasks">
        <button class="filter active" data-filter="all">All</button>
        <button class="filter" data-filter="active">Active</button>
        <button class="filter" data-filter="completed">Completed</button>
      </div>
    </div>

    <ul class="todo-list" id="list" aria-live="polite"></ul>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
      <button id="clearCompleted" class="icon-btn">Clear completed</button>
      <div class="small">Double-click a task to edit. Esc to cancel. Enter to save.</div>
    </div>
  </main>

  <script>
    /* ======= Simple todo app in vanilla JS =======
       Features:
         - add / edit / delete / toggle complete
         - filters: all / active / completed
         - persist in localStorage
         - keyboard support (Enter to add; Enter/Esc when editing)
    */

    const storageKey = 'vanilla_todos_v1'
    const listEl = document.getElementById('list')
    const input = document.getElementById('taskInput')
    const addBtn = document.getElementById('addBtn')
    const itemsLeft = document.getElementById('itemsLeft')
    const filters = document.querySelectorAll('.filter')
    const clearCompletedBtn = document.getElementById('clearCompleted')

    let todos = []
    let activeFilter = 'all'

    // --- storage ---
    function load() {
      try {
        const raw = localStorage.getItem(storageKey)
        todos = raw ? JSON.parse(raw) : []
      } catch (e) { todos = [] }
    }
    function save() { localStorage.setItem(storageKey, JSON.stringify(todos)) }

    // --- helpers ---
    function uid() { return Date.now().toString(36) + Math.random().toString(36).slice(2,8) }

    // --- render ---
    function render() {
      listEl.innerHTML = ''
      const filtered = todos.filter(t => {
        if (activeFilter === 'active') return !t.done
        if (activeFilter === 'completed') return t.done
        return true
      })

      if (filtered.length === 0) {
        const empty = document.createElement('div')
        empty.className = 'small'
        empty.style.padding = '16px'
        empty.style.opacity = '0.7'
        empty.textContent = 'No tasks yet â€” add one above!'
        listEl.appendChild(empty)
      }

      for (const t of filtered) listEl.appendChild(renderItem(t))

      const left = todos.filter(t => !t.done).length
      itemsLeft.textContent = left + (left===1 ? ' item left' : ' items left')
    }

    function renderItem(todo) {
      const li = document.createElement('li')
      li.className = 'todo' + (todo.done ? ' completed' : '')
      li.dataset.id = todo.id

      // checkbox
      const cb = document.createElement('button')
      cb.className = 'cb'
      cb.setAttribute('aria-pressed', String(!!todo.done))
      cb.title = todo.done ? 'Mark as active' : 'Mark as completed'
      cb.innerHTML = todo.done ? '&#10003;' : ''
      cb.addEventListener('click', () => {
        toggleDone(todo.id)
      })

      // label (editable)
      const label = document.createElement('div')
      label.className = 'label'
      label.tabIndex = 0
      label.textContent = todo.text
      label.title = 'Double click to edit'

      // editing behavior: double-click to edit inline
      label.addEventListener('dblclick', () => startEdit(li, todo))

      // keyboard focus -> Enter to start editing
      label.addEventListener('keydown', (ev) => {
        if (ev.key === 'Enter') { ev.preventDefault(); startEdit(li, todo) }
      })

      // actions: edit / delete
      const actions = document.createElement('div')
      actions.className = 'actions'

      const editBtn = document.createElement('button')
      editBtn.className = 'icon-btn'
      editBtn.title = 'Edit'
      editBtn.innerHTML = 'âœï¸'
      editBtn.addEventListener('click', () => startEdit(li, todo))

      const delBtn = document.createElement('button')
      delBtn.className = 'icon-btn'
      delBtn.title = 'Delete'
      delBtn.innerHTML = 'ðŸ—‘ï¸'
      delBtn.addEventListener('click', () => removeTodo(todo.id))

      actions.appendChild(editBtn)
      actions.appendChild(delBtn)

      li.appendChild(cb)
      li.appendChild(label)
      li.appendChild(actions)

      return li
    }

    // --- CRUD ---
    function addTodo(text) {
      const trimmed = text.trim()
      if (!trimmed) return
      todos.unshift({ id: uid(), text: trimmed, done: false })
      save()
      render()
      input.value = ''
      input.focus()
    }

    function removeTodo(id) {
      todos = todos.filter(t => t.id !== id)
      save(); render()
    }

    function toggleDone(id) {
      const t = todos.find(x => x.id === id)
      if (!t) return
      t.done = !t.done
      save(); render()
    }

    function clearCompleted() {
      todos = todos.filter(t => !t.done)
      save(); render()
    }

    function updateText(id, newText) {
      const t = todos.find(x => x.id === id)
      if (!t) return
      t.text = newText.trim() || t.text
      save(); render()
    }

    // --- editing UI ---
    function startEdit(li, todo) {
      // replace label with input
      const label = li.querySelector('.label')
      const inputEdit = document.createElement('input')
      inputEdit.type = 'text'
      inputEdit.value = todo.text
      inputEdit.style.width = '100%'
      inputEdit.style.padding = '6px'
      inputEdit.style.borderRadius = '8px'
      inputEdit.style.border = '1px solid rgba(255,255,255,0.06)'

      // swap
      li.replaceChild(inputEdit, label)
      inputEdit.focus()
      // select text
      inputEdit.setSelectionRange(0, inputEdit.value.length)

      function finish(saveFlag) {
        if (saveFlag) updateText(todo.id, inputEdit.value)
        else render()
        cleanup()
      }
      function cleanup() {
        inputEdit.removeEventListener('blur', onBlur)
        inputEdit.removeEventListener('keydown', onKeydown)
      }
      function onBlur() { finish(true) }
      function onKeydown(e) {
        if (e.key === 'Enter') { finish(true) }
        if (e.key === 'Escape') { finish(false) }
      }
      inputEdit.addEventListener('blur', onBlur)
      inputEdit.addEventListener('keydown', onKeydown)
    }

    // --- events ---
    addBtn.addEventListener('click', () => addTodo(input.value))
    input.addEventListener('keydown', (e) => { if (e.key === 'Enter') addTodo(input.value) })

    filters.forEach(f => f.addEventListener('click', (e) => {
      filters.forEach(ff => ff.classList.remove('active'))
      e.currentTarget.classList.add('active')
      activeFilter = e.currentTarget.dataset.filter
      render()
    }))

    clearCompletedBtn.addEventListener('click', clearCompleted)

    // initialize
    load(); render()

    // expose for debugging (optional)
    window._todos = todos
  </script>
</body>
</html>
